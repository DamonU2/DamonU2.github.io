name: Check for README.md and LISEZMOI.md

on:
  push:
  workflow_dispatch:

jobs:
  readme-check:
    runs-on: ubuntu-latest
    steps:
    - name: Get list of repos
      env:
        TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        result=`curl -H "Authorization: $TOKEN" -H "Accept: application/vnd.github.v3+json" https://api.github.com/orgs/DamonU2/repos?per_page=100 | jq .[].name | tr -d \"`
        results=($result)
        for REPO in "${results[@]}"
        do
          echo $REPO
          RESPONSE=`curl -i https://api.github.com/repos/DamonU2/$REPO/contents/README.md --write-out "%{http_code}\n" --output /dev/null --silent`
          echo $RESPONSE
          FRESPONSE=`curl -i -H "Authorization: $TOKEN" https://api.github.com/repos/DamonU2/$REPO/contents/LISEZMOI.md --write-out "%{http_code}\n" --output /dev/null --silent`
          echo $FRESPONSE
        done
